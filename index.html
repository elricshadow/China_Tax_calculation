<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <title>中国税费计算器-含增值税及所得税计算</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f4f8ff;
      --card:#ffffff;
      --primary:#2f5bd8;
      --accent:#6fb7ff;
      --muted:#6b7a9a;
      --success:#2e7d32;
      --danger:#e53935;
      --glass: rgba(255,255,255,0.75);
      --radius:12px;
      --shadow: 0 8px 30px rgba(47,91,216,0.08);
      --gap:18px;
      --maxw:1100px;
    }

    html,body{
      height:100%;
      margin:0;
      background: linear-gradient(180deg,var(--bg), #ffffff 60%);
      font-family: "Inter", "Segoe UI", "PingFang SC", "Helvetica Neue", Arial, sans-serif;
      color:#1f2a44;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .wrap{
      max-width:var(--maxw);
      margin:28px auto;
      padding:20px;
    }

    header.app-header{
      display:flex;
      align-items:center;
      gap:16px;
      margin-bottom:18px;
    }
    .logo {
      width:56px;
      height:56px;
      border-radius:12px;
      background:linear-gradient(135deg,var(--primary),var(--accent));
      display:flex;
      align-items:center;
      justify-content:center;
      color:white;
      font-weight:700;
      box-shadow: 0 6px 18px rgba(47,91,216,0.12);
      flex-shrink:0;
    }
    .title-group{
      display:flex;
      flex-direction:column;
    }
    h1{
      margin:0;
      font-size:1.15rem;
      color:var(--primary);
      letter-spacing:0.6px;
    }
    .subtitle{
      margin-top:4px;
      color:var(--muted);
      font-size:0.9rem;
    }

    main.grid {
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:var(--gap);
      align-items:start;
    }

    /* Left column (main calculators) */
    .main-card {
      background: var(--card);
      border-radius: var(--radius);
      padding:20px;
      box-shadow: var(--shadow);
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    /* Right column (results, reference) */
    .side-card {
      background: linear-gradient(180deg, rgba(255,255,255,0.98), var(--card));
      border-radius: var(--radius);
      padding:18px;
      box-shadow: var(--shadow);
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .section {
      background: linear-gradient(180deg, var(--glass), rgba(255,255,255,0.9));
      border-radius:10px;
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      border:1px solid rgba(47,91,216,0.03);
    }
    .section .section-title {
      display:flex;
      gap:8px;
      align-items:center;
      font-weight:700;
      color:var(--primary);
    }
    .controls {
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    label.small {
      font-size:0.9rem;
      color:var(--muted);
      margin-bottom:6px;
    }

    input[type="number"], select {
      padding:10px 12px;
      border-radius:8px;
      border:1px solid rgba(47,91,216,0.12);
      background: #fff;
      font-size:0.98rem;
      color:#111827;
      outline:none;
      min-width:0;
      box-sizing:border-box;
    }
    input[type="number"]:focus, select:focus { box-shadow:0 6px 18px rgba(47,91,216,0.06); border-color:var(--primary); }

    .row {
      display:flex;
      gap:10px;
      align-items:center;
      width:100%;
    }
    .row .flex-1 { flex:1; }
    .row .w-160 { width:160px; }
    .row .w-120 { width:120px; }
    .row .w-80  { width:80px; }

    .btn {
      padding:11px 14px;
      background:linear-gradient(90deg,var(--primary),var(--accent));
      color:#fff;
      border:none;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      box-shadow: 0 8px 20px rgba(47,91,216,0.12);
      transition:transform .12s ease;
    }
    .btn:active{ transform:translateY(1px); }
    .btn.ghost {
      background:transparent;
      color:var(--primary);
      border:1px solid rgba(47,91,216,0.08);
      box-shadow:none;
    }

    /* city tax cards */
    .tax-city-row {
      display:flex;
      gap:10px;
    }
    .tax-city-card {
      flex:1;
      padding:10px 8px;
      border-radius:8px;
      border:1px solid rgba(47,91,216,0.06);
      background:linear-gradient(180deg,#ffffff,#fbfdff);
      text-align:center;
      cursor:pointer;
      transition:all .12s;
      color:var(--muted);
      font-weight:600;
      font-size:0.95rem;
    }
    .tax-city-card .rate { margin-top:6px; color:var(--success); font-weight:800; }
    .tax-city-card.selected {
      border-color: rgba(47,91,216,0.18);
      box-shadow: 0 8px 20px rgba(47,91,216,0.06);
      color:var(--primary);
      background: linear-gradient(180deg,#eef5ff,#e6f0ff);
    }

    /* results layout */
    .result .line { display:flex; justify-content:space-between; gap:8px; align-items:center; padding:6px 0; border-bottom:1px dashed rgba(31,42,68,0.04); }
    .result .line:last-child { border-bottom:none; }
    .muted { color:var(--muted); font-size:0.92rem; }
    .value { color:#0b3b8a; font-weight:700; }

    .small-note { font-size:0.88rem; color:var(--muted); }

    /* Responsive */
    @media (max-width:980px){
      main.grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="app-header" aria-hidden="false">
      <div class="logo">税</div>
      <div class="title-group">
        <h1>中国税费计算器 </h1>
        <div class="subtitle">增值税（含附加） · 个体工商户 · 个人所得税</div>
      </div>
    </header>

    <main class="grid" role="main">
      <!-- LEFT: calculators -->
      <section class="main-card" aria-label="计算器">
        <!-- VAT Section -->
        <div class="section" id="vat-section">
          <div class="section-title">🧾 增值税计算</div>

          <div class="row">
            <div class="flex-1">
              <label class="small">金额（元）</label>
              <input id="amount" type="number" min="0" step="0.01" placeholder="请输入金额">
            </div>
            <div class="w-160">
              <label class="small">金额模式</label>
              <select id="mode" title="金额模式">
                <option value="exclusive">未含税（基数）</option>
                <option value="inclusive">含税（倒算）</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div class="flex-1">
              <label class="small">税率（%）</label>
              <select id="rate-select" onchange="updateRateInput()">
                <option value="13">13%</option>
                <option value="11">11%</option>
                <option value="10">10%</option>
                <option value="9">9%</option>
                <option value="6">6%</option>
                <option value="3">3%</option>
                <option value="1">1%</option>
                <option value="0">0%</option>
                <option value="other">自定义</option>
              </select>
            </div>
            <div class="w-120">
              <label class="small">税率手动</label>
              <input id="rate" class="" type="number" min="0" max="100" step="0.01" value="13">
            </div>
            <div class="w-80" style="align-self:flex-end;">
              <button class="btn" onclick="calculateVAT()">计算</button>
            </div>
          </div>

          <div style="margin-top:8px;">
            <div class="small-note">附：小规模免征参考阈值 ≤ ¥100,000（请按税务机关认定为准）</div>
          </div>
        </div>

        <!-- Individual Biz (个体工商户) -->
        <div class="section" id="biz-section">
          <div class="section-title">🏢 个体工商户所得税（按月）</div>

          <div class="row">
            <div class="flex-1">
              <label class="small">经营收入（元）</label>
              <input id="biz-income" type="number" min="0" step="0.01" placeholder="请输入经营收入">
            </div>
            <div class="w-160">
              <label class="small">月度起征点</label>
              <select id="biz-threshold-select" onchange="updateBizThresholdInput()">
                <option value="5000">5000元</option>
                <option value="10000">10000元</option>
                <option value="20000">20000元</option>
                <option value="30000">30000元</option>
                <option value="other">自定义</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div class="flex-1">
              <label class="small">自定义起征点 / 专项扣除</label>
              <div style="display:flex; gap:8px;">
                <input id="biz-threshold" type="number" placeholder="自定义起征点" min="0" step="0.01">
                <input id="biz-deduct" type="number" placeholder="专项扣除（可选）" min="0" step="0.01">
              </div>
            </div>
            <div style="width:80px; align-self:flex-end;">
              <button class="btn" onclick="handleCalculateBiz()">计算</button>
            </div>
          </div>
        </div>

        <!-- Personal Salary Tax -->
        <div class="section" id="personal-section">
          <div class="section-title">🧾 个人所得税（工资薪金）</div>

          <div class="row">
            <div class="flex-1">
              <label class="small">税前工资（元）</label>
              <input id="salary" type="number" min="0" step="0.01" placeholder="请输入税前工资">
            </div>
            <div class="w-160">
              <label class="small">起征点</label>
              <select id="salary-threshold-select" onchange="updateSalaryThresholdInput()">
                <option value="5000">5000元（默认）</option>
                <option value="8000">8000元</option>
                <option value="10000">10000元</option>
                <option value="other">自定义</option>
              </select>
            </div>
          </div>

          <div class="row" style="align-items:flex-end;">
            <div class="flex-1">
              <input id="salary-threshold" type="number" placeholder="自定义起征点" min="0" step="0.01">
              <div class="small-note" style="margin-top:8px;">停用税前专项明细，如需精确计算可扩展专项扣除项。</div>
            </div>
            <div style="width:80px;">
              <button class="btn" onclick="handleCalculatePersonal()">计算</button>
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT: results and controls -->
      <aside class="side-card" aria-label="结果面板">
        <!-- VAT result + city card -->
        <div style="display:flex; flex-direction:column; gap:12px;">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <div style="font-weight:700; color:var(--primary);">增值税与附加税 结果</div>
            <div class="small-note">结果会在此显示</div>
          </div>

          <div style="display:flex; flex-direction:column; gap:8px;">
            <div class="tax-city-row" id="tax-city-row">
              <div class="tax-city-card selected" data-rate="0.07" onclick="selectCity(this)">
                城市 <div class="rate">7%</div>
              </div>
              <div class="tax-city-card" data-rate="0.05" onclick="selectCity(this)">
                县/镇 <div class="rate">5%</div>
              </div>
              <div class="tax-city-card" data-rate="0.01" onclick="selectCity(this)">
                乡/村 <div class="rate">1%</div>
              </div>
            </div>
            <div style="display:flex; gap:8px; align-items:center;">
              <input id="apply-exempt" type="checkbox" class="checkbox" />
              <label class="small">按小规模免征计算（若符合则勾选）</label>
            </div>
            <div id="vat-result" class="result" tabindex="0" aria-live="polite">
              <div class="muted">请在左侧输入金额并点击“计算”</div>
            </div>
          </div>
        </div>

        <!-- Biz result -->
        <div>
          <div style="font-weight:700; color:var(--primary); margin-top:6px;">个体工商户 计算结果</div>
          <div id="biz-result" class="result" aria-live="polite">
            <div class="muted">尚无结果</div>
          </div>
        </div>

        <!-- Personal result -->
        <div>
          <div style="font-weight:700; color:var(--primary); margin-top:6px;">个人所得税 计算结果</div>
          <div id="income-result" class="result" aria-live="polite">
            <div class="muted">尚无结果</div>
          </div>
        </div>
      </aside>
    </main>
  </div>

  <script>
    // ---- basic UI behaviors ----
    function selectCity(card){
      document.querySelectorAll('.tax-city-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
    }
    function getSelectedCityRate(){
      var sel = document.querySelector('.tax-city-card.selected');
      return sel ? parseFloat(sel.getAttribute('data-rate')) : 0.07;
    }
    function updateRateInput(){
      var sel = document.getElementById('rate-select'), inp = document.getElementById('rate');
      if(sel.value === 'other'){ inp.value = ''; inp.focus(); } else inp.value = sel.value;
    }
    function selectOtherRate(){
      var inp = document.getElementById('rate'), sel = document.getElementById('rate-select');
      var presets = ['13','11','10','9','6','3','1','0'];
      if(!presets.includes(String(inp.value))) sel.value = 'other';
    }

    // ---- VAT + surcharges calculation (keeps v16 logic) ----
    function calculateVAT(){
      var amountRaw = parseFloat(document.getElementById('amount').value);
      var mode = document.getElementById('mode').value;
      var rate = parseFloat(document.getElementById('rate').value);
      var vatResultEl = document.getElementById('vat-result');
      var cityRate = getSelectedCityRate();
      var applyExempt = document.getElementById('apply-exempt').checked;

      if(isNaN(amountRaw) || amountRaw < 0 || isNaN(rate) || rate < 0 || rate > 100){
        vatResultEl.innerHTML = '<div style="color:'+getComputedStyle(document.documentElement).getPropertyValue('--danger')+'">请输入有效的金额和税率（税率 0 - 100）</div>';
        return;
      }

      var r = rate/100;
      var taxableBase_excl=0, vatPayable=0, totalWithVat=0, vatInside=0, amountWithoutTax=0;
      if(mode === 'exclusive'){
        taxableBase_excl = amountRaw;
        vatPayable = taxableBase_excl * r;
        totalWithVat = taxableBase_excl + vatPayable;
        vatInside = vatPayable;
        amountWithoutTax = taxableBase_excl;
      } else {
        totalWithVat = amountRaw;
        vatInside = amountRaw * r / (1 + r);
        amountWithoutTax = amountRaw / (1 + r);
        taxableBase_excl = amountWithoutTax;
        vatPayable = vatInside;
      }

      var smallScaleThreshold = 100000;
      var isSmallScaleCandidate = taxableBase_excl <= smallScaleThreshold;
      var effectiveVat = vatPayable;
      if(applyExempt && isSmallScaleCandidate) effectiveVat = 0;

      var cityTax = effectiveVat * cityRate;
      var eduTax = effectiveVat * 0.03;
      var localEduTax = effectiveVat * 0.02;
      var totalSurcharges = cityTax + eduTax + localEduTax;

      // Build result HTML (clean and structured)
      var out = '';
      if(isSmallScaleCandidate){
        out += '<div class="small-note" style="color:#b56d00;">提示：未含税金额 ≤ ¥' + smallScaleThreshold.toLocaleString() + '，可能符合小规模免征（仅供参考）</div>';
      }

      out += '<div class="tax-type">增值税（' + (mode==='exclusive' ? '未含税基数' : '含税倒算') + '）</div>';
      out += '<div class="line"><div class="muted">未含税金额（基数）</div><div class="value">' + taxableBase_excl.toFixed(2) + ' 元</div></div>';
      out += '<div class="line"><div class="muted">增值税（' + rate.toFixed(2) + '%）</div><div class="value">' + vatPayable.toFixed(2) + ' 元</div></div>';
      out += '<div class="line"><div class="muted">含税总额</div><div class="value">' + totalWithVat.toFixed(2) + ' 元</div></div>';

      out += '<div class="tax-type">价内税（倒算示例）</div>';
      out += '<div class="line"><div class="muted">倒算增值税</div><div class="value">' + vatInside.toFixed(2) + ' 元</div></div>';
      out += '<div class="line"><div class="muted">倒算未含税金额</div><div class="value">' + amountWithoutTax.toFixed(2) + ' 元</div></div>';

      out += '<div class="tax-type">附加税费（以应缴增值税为基数）</div>';
      out += '<div class="line"><div class="muted">城建税（' + (cityRate*100).toFixed(2) + '%）</div><div class="value">' + cityTax.toFixed(2) + ' 元</div></div>';
      out += '<div class="line"><div class="muted">教育费附加（3%）</div><div class="value">' + eduTax.toFixed(2) + ' 元</div></div>';
      out += '<div class="line"><div class="muted">地方教育附加（2%）</div><div class="value">' + localEduTax.toFixed(2) + ' 元</div></div>';
      out += '<div class="line"><div class="muted">附加税合计</div><div class="value">' + totalSurcharges.toFixed(2) + ' 元</div></div>';

      if(applyExempt && isSmallScaleCandidate){
        out += '<div class="small-note" style="color:#a12b1b; margin-top:8px;"><b>按小规模免征：增值税与附加税均视为 0（仅在税务认定后适用）</b></div>';
      } else if(isSmallScaleCandidate){
        out += '<div class="small-note">若申报免征：增值税、城建税、教育费附加与地方教育附加均为 0（供对比参考）</div>';
      }

      vatResultEl.innerHTML = out;
      vatResultEl.focus && vatResultEl.focus();
    }

    // ---- Tax calculation functions (personal & biz) ----
    function round2(v){ return Math.round((v + Number.EPSILON) * 100) / 100; }

    function getPersonalBracket(taxable){
      var rate=0,q=0,level='';
      if(taxable<=3000){ rate=3; q=0; level='第1级 (≤3,000)'; }
      else if(taxable<=12000){ rate=10; q=210; level='第2级 (3,000~12,000)'; }
      else if(taxable<=25000){ rate=20; q=1410; level='第3级 (12,000~25,000)'; }
      else if(taxable<=35000){ rate=25; q=2660; level='第4级 (25,000~35,000)'; }
      else if(taxable<=55000){ rate=30; q=4410; level='第5级 (35,000~55,000)'; }
      else if(taxable<=80000){ rate=35; q=7160; level='第6级 (55,000~80,000)'; }
      else { rate=45; q=15160; level='第7级 (>80,000)'; }
      return { rate, quickDeduction:q, level };
    }

    function getPersonalSalaryTax(salary, options){
      options = options || {};
      var threshold = typeof options.threshold === 'number' ? options.threshold : 5000;
      var keepNegative = !!options.keepNegativeTaxable;
      if(isNaN(salary) || salary < 0) throw new Error('salary 必须为非负数字');
      var taxable = round2(salary - threshold);
      if(!keepNegative && taxable < 0) taxable = 0;
      if(taxable === 0){
        return { salary:round2(salary), threshold:round2(threshold), taxable:taxable, rate:0, quickDeduction:0, tax:0, net:round2(salary), bracket:'免税' };
      }
      var bracket = getPersonalBracket(taxable);
      var tax = round2(taxable * bracket.rate / 100 - bracket.quickDeduction);
      if(tax < 0) tax = 0;
      var net = round2(salary - tax);
      return { salary:round2(salary), threshold:round2(threshold), taxable:round2(taxable), rate:bracket.rate, quickDeduction:bracket.quickDeduction, tax, net, bracket:bracket.level };
    }

    function getBizBracketMonthly(taxable){
      var rate=0,q=0,level='';
      if(taxable<=30000){ rate=5; q=0; level='第1级 (≤30,000)'; }
      else if(taxable<=90000){ rate=10; q=1500; level='第2级 (30,000~90,000)'; }
      else if(taxable<=300000){ rate=20; q=10500; level='第3级 (90,000~300,000)'; }
      else if(taxable<=500000){ rate=30; q=40500; level='第4级 (300,000~500,000)'; }
      else { rate=35; q=65500; level='第5级 (>500,000)'; }
      return { rate, quickDeduction:q, level };
    }

    function getBizIncomeTaxMonthly(income, options){
      options = options || {};
      var threshold = typeof options.threshold === 'number' ? options.threshold : 5000;
      var deduction = typeof options.deduction === 'number' ? options.deduction : 0;
      var keepNegative = !!options.keepNegativeTaxable;
      if(isNaN(income) || income < 0) throw new Error('income 必须为非负数字');
      if(isNaN(deduction) || deduction < 0) deduction = 0;
      if(isNaN(threshold) || threshold < 0) threshold = 5000;
      var taxable = round2(income - threshold - deduction);
      if(!keepNegative && taxable < 0) taxable = 0;
      if(taxable === 0) return { income:round2(income), threshold:round2(threshold), deduction:round2(deduction), taxable:taxable, rate:0, quickDeduction:0, tax:0, net:round2(income), bracket:'免税' };
      var bracket = getBizBracketMonthly(taxable);
      var tax = round2(taxable * bracket.rate / 100 - bracket.quickDeduction);
      if(tax < 0) tax = 0;
      var net = round2(income - tax);
      return { income:round2(income), threshold:round2(threshold), deduction:round2(deduction), taxable:round2(taxable), rate:bracket.rate, quickDeduction:bracket.quickDeduction, tax, net, bracket:bracket.level };
    }

    // expose for debugging
    window.getPersonalSalaryTax = getPersonalSalaryTax;
    window.getBizIncomeTaxMonthly = getBizIncomeTaxMonthly;

    // ---- page bindings ----
    function updateBizThresholdInput(){
      var sel = document.getElementById('biz-threshold-select'), inp = document.getElementById('biz-threshold');
      if(sel.value === 'other'){ inp.value=''; inp.focus(); } else inp.value = sel.value;
    }
    function updateSalaryThresholdInput(){
      var sel = document.getElementById('salary-threshold-select') || {value:'5000'}, inp = document.getElementById('salary-threshold');
      if(sel.value === 'other'){ inp.value=''; inp.focus(); } else inp.value = sel.value;
    }

    function handleCalculateBiz(){
      var income = parseFloat(document.getElementById('biz-income').value);
      var threshold = parseFloat(document.getElementById('biz-threshold').value);
      var deduction = parseFloat(document.getElementById('biz-deduct').value);
      var resEl = document.getElementById('biz-result');
      if(isNaN(income) || income < 0){ resEl.innerHTML = '<div class="err">请输入有效的经营收入</div>'; return; }
      if(isNaN(threshold) || threshold < 0) threshold = 5000;
      if(isNaN(deduction) || deduction < 0) deduction = 0;
      try{
        var result = getBizIncomeTaxMonthly(income, { threshold: threshold, deduction: deduction });
        var html = '';
        html += '<div class="line"><div class="muted">经营收入</div><div class="value">' + result.income.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">起征点</div><div class="value">' + result.threshold.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">专项扣除</div><div class="value">' + result.deduction.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">应纳税所得额</div><div class="value">' + result.taxable.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">适用税率</div><div class="value">' + result.rate + '%（' + result.bracket + '）</div></div>';
        html += '<div class="line"><div class="muted">速算扣除数</div><div class="value">' + result.quickDeduction + ' 元</div></div>';
        html += '<div class="line"><div class="muted">应纳税额</div><div class="value" style="color:'+getComputedStyle(document.documentElement).getPropertyValue('--danger')+'">' + result.tax.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">税后收入</div><div class="value" style="color:'+getComputedStyle(document.documentElement).getPropertyValue('--success')+'">' + result.net.toFixed(2) + ' 元</div></div>';
        resEl.innerHTML = html;
      }catch(e){
        resEl.innerHTML = '<div class="err">' + e.message + '</div>';
      }
    }

    function handleCalculatePersonal(){
      var salary = parseFloat(document.getElementById('salary').value);
      var threshold = parseFloat(document.getElementById('salary-threshold').value);
      var resEl = document.getElementById('income-result');
      if(isNaN(salary) || salary < 0){ resEl.innerHTML = '<div class="err">请输入有效的税前工资</div>'; return; }
      if(isNaN(threshold) || threshold < 0) threshold = 5000;
      try{
        var result = getPersonalSalaryTax(salary, { threshold: threshold });
        var html = '';
        html += '<div class="line"><div class="muted">税前工资</div><div class="value">' + result.salary.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">起征点</div><div class="value">' + result.threshold.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">应纳税所得额</div><div class="value">' + result.taxable.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">适用税率</div><div class="value">' + result.rate + '%（' + result.bracket + '）</div></div>';
        html += '<div class="line"><div class="muted">速算扣除数</div><div class="value">' + result.quickDeduction + ' 元</div></div>';
        html += '<div class="line"><div class="muted">应纳税额</div><div class="value" style="color:'+getComputedStyle(document.documentElement).getPropertyValue('--danger')+'">' + result.tax.toFixed(2) + ' 元</div></div>';
        html += '<div class="line"><div class="muted">实发工资</div><div class="value" style="color:'+getComputedStyle(document.documentElement).getPropertyValue('--success')+'">' + result.net.toFixed(2) + ' 元</div></div>';
        resEl.innerHTML = html;
      }catch(e){
        resEl.innerHTML = '<div class="err">' + e.message + '</div>';
      }
    }

    // init values
    (function init(){
      // default thresholds
      var bizThreshold = document.getElementById('biz-threshold');
      var salaryThreshold = document.getElementById('salary-threshold');
      if(bizThreshold) bizThreshold.value = '5000';
      if(salaryThreshold) salaryThreshold.value = '5000';
      // ensure one selected city
      if(!document.querySelector('.tax-city-card.selected')){
        var f = document.querySelector('.tax-city-card');
        if(f) f.classList.add('selected');
      }
    })();
  </script>
</body>
</html>
